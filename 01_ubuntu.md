# Первоначальная базовая настройка Ubunut 20.04

**Основная статья: [Начальная настройка сервера с помощью Ubuntu 20.04](https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-20-04-ru)**

В начале всего я захожу под root на сервер и проверяю доступность обновлений.

`$ apt update`

Получаю список доступных пакетов

`$ apt list --upgradable`

И при наличии таковых обновляю

`$ apt upgrade`

Повторный ввод команды `$ apt update` должен вывести информация об отсутствии пакетов для обновления. Или такая информация будет предоставлена при первом запросе, если пакеты для обновления отсутствуют.

![](/images/screen_01.jpg)

## Создание нового пользователя

Я не буду работать под root и для работы я создам суперпользователя *(пользователь с привелегиями root)*.

`$ adduser username` где username любое имя.

И добавлю ему привелегии root

`$ usermod -aG sudo username`

Теперь, когда у нас есть стандартный пользователь для повседневного использования, необходимо убедиться, что мы можем ввойти через SSH непосредственно в учетную запись. Теперь все настройки сервера и установки ПО я буду делать из под данного пользователя.

## Настройка базового брандмауэра

Далее я хочу настроить брандмауэр так, чтобы только я с конкретного айпи смог подключится по нужному мне порту.

`$ ufw app list`

![](/images/screen_02.jpg)

Для разрешения подключения по SSH ввожу команду `$ ufw allow OpenSSH` и активирую брандмауэр `$ ufw enable`

![](/images/screen_03.jpg)

Если проверить статус брандмауэра командо `$ ufw status` то получим следующее

![](/images/screen_04.jpg)

## Повышение уровня безопасности

**Основная статья: [Настройка ключей SSH в Ubuntu 20.04](https://www.digitalocean.com/community/tutorials/how-to-set-up-ssh-keys-on-ubuntu-20-04-ru)**

Для повышения уровня безопасности я проведу простейшие манипулации: я отключу аутентифакацию на сервер по паролю для всех пользователей и настрою подключение через ssh ключи. Теперь если кто и узнает мой пароль, всё равно не сможет авторизоваться на сервере не имея нужный ключ.

Для начало на моём локальном компьютере (домашний или рабочий станционарный ПК) я сгенерирую новую пару ключей:

`$ ssh-keygen -t rsa`

Далее необходимо создать директорию (если не создана) /.ssh на сервере будучи авторизованным нашим новым (основным) пользователем.

`$ mkdir -p ~/.ssh`

Далее я просто скопирую содержимое публичного ключа в файл **authorized_keys**, а если такого нет, то этой же командой и создам его

`$ echo public_key_string >> ~/.ssh/authorized_keys` где *public_key_string* это содержимое публичного ключа

Теперь необходимо отключить (после того как аутентификация для всех пользователей через ключ была настроена) авторизацию по паролю

`$ nano /etc/ssh/sshd_config`

В данном файле найти строку (скорее всего закомментирована #) и параметр **yes** поменять на **no**

```
...
PasswordAuthentication no
...
```
и сделать рестарт ssh

`$ systemctl restart ssh`
